<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>„ÇØ„Ç§„Ç∫„É©„É≥„Ç≠„É≥„Ç∞</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 20px;
    }

    h1 {
      text-align: center;
    }

    .container {
      display: flex;
      gap: 20px;
    }

    .form-area, .ranking-area {
      flex: 1;
      background: white;
      padding: 15px;
      border-radius: 8px;
    }

    iframe {
      width: 100%;
      height: 80vh;
      border: none;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }

    th {
      background: #333;
      color: white;
    }

    .rank-1 { background: #ffd700; font-weight: bold; }
    .rank-2 { background: #c0c0c0; font-weight: bold; }
    .rank-3 { background: #cd7f32; font-weight: bold; }
  </style>
</head>
<body>

<h1>üèÜ „ÇØ„Ç§„Ç∫Â§ß‰ºö</h1>

<div class="container">

  <!-- ÂõûÁ≠î„Éï„Ç©„Éº„É† -->
  <div class="form-area">
    <h2>ÂõûÁ≠î„Éï„Ç©„Éº„É†</h2>
    <iframe
      src="https://docs.google.com/forms/d/e/1FAIpQLSeg5fhJqtw_q3kJS0ZO7XDdhRBhgMK_rcpQhfebisCLMqtLYg/viewform?usp=header">
    </iframe>
  </div>

  <!-- „É©„É≥„Ç≠„É≥„Ç∞ -->
  <div class="ranking-area">
    <h2>„É©„É≥„Ç≠„É≥„Ç∞</h2>
    <table>
      <thead>
        <tr>
          <th>È†Ü‰Ωç</th>
          <th>„Ç∞„É´„Éº„Éó</th>
          <th>ÁÇπÊï∞</th>
        </tr>
      </thead>
      <tbody id="ranking"></tbody>
    </table>
  </div>

</div>

<script>
const GAS_URL = "„Åì„Åì„Å´GAS„ÅÆWeb„Ç¢„Éó„É™URL";

function updateRanking() {
  fetch(GAS_URL)
    .then(res => res.json())
    .then(data => {
      const list = Object.entries(data)
        .map(([group, score]) => ({ group, score }))
        .sort((a, b) => b.score - a.score);

      let prevScore = null;
      let displayRank = 0;

      const tbody = document.getElementById("ranking");
      tbody.innerHTML = "";

      list.forEach((item, index) => {
        if (item.score !== prevScore) {
          displayRank = index + 1;
        }
        prevScore = item.score;

        const tr = document.createElement("tr");
        if (displayRank <= 3) tr.classList.add(`rank-${displayRank}`);

        tr.innerHTML = `
          <td>${displayRank}‰Ωç</td>
          <td>${item.group}</td>
          <td>${item.score}</td>
        `;

        tbody.appendChild(tr);
      });
    });
}

updateRanking();
setInterval(updateRanking, 5000);
</script>

</body>
</html>
