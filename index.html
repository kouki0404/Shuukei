<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ã‚¯ã‚¤ã‚ºãƒ©ãƒ³ã‚­ãƒ³ã‚°</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f5f5f5;
      padding: 30px;
    }

    h1 {
      text-align: center;
    }

    table {
      margin: auto;
      border-collapse: collapse;
      width: 60%;
      background: white;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: center;
    }

    th {
      background: #333;
      color: white;
    }

    tr:nth-child(even) {
      background: #f0f0f0;
    }

    .rank-1 {
      background: #ffd700 !important;
      font-weight: bold;
    }

    .rank-2 {
      background: #c0c0c0 !important;
      font-weight: bold;
    }

    .rank-3 {
      background: #cd7f32 !important;
      font-weight: bold;
    }
  </style>
</head>
<body>

<h1>ğŸ† ã‚¯ã‚¤ã‚ºãƒ©ãƒ³ã‚­ãƒ³ã‚°</h1>

<table>
  <thead>
    <tr>
      <th>é †ä½</th>
      <th>ã‚°ãƒ«ãƒ¼ãƒ—</th>
      <th>ç‚¹æ•°</th>
    </tr>
  </thead>
  <tbody id="ranking"></tbody>
</table>

<script>
const GAS_URL = "ã“ã“ã«GASã®Webã‚¢ãƒ—ãƒªURL";

function updateRanking() {
  fetch(GAS_URL)
    .then(res => res.json())
    .then(data => {
      // é…åˆ—åŒ–
      const list = Object.entries(data)
        .map(([group, score]) => ({ group, score }))
        .sort((a, b) => b.score - a.score);

      let rank = 0;
      let prevScore = null;
      let displayRank = 0;

      const tbody = document.getElementById("ranking");
      tbody.innerHTML = "";

      list.forEach((item, index) => {
        if (item.score !== prevScore) {
          rank = index + 1;
          displayRank = rank;
        }

        prevScore = item.score;

        const tr = document.createElement("tr");

        if (displayRank <= 3) {
          tr.classList.add(`rank-${displayRank}`);
        }

        tr.innerHTML = `
          <td>${displayRank}ä½</td>
          <td>${item.group}</td>
          <td>${item.score}</td>
        `;

        tbody.appendChild(tr);
      });
    });
}

// åˆå›ï¼‹5ç§’ã”ã¨æ›´æ–°
updateRanking();
setInterval(updateRanking, 5000);
</script>

</body>
</html>
